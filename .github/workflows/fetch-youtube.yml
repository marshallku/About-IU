name: Get recent youtube videos

on:
    schedule:
        - cron: "0 15 * * *"
    push:
        paths:
            - ".github/scripts"
    workflow_dispatch:

jobs:
    fetch-youtube:
        name: Get recent youtube videos
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v3
            - uses: actions/setup-node@v3
              with:
                  node-version: "16"
                  check-latest: true
                  registry-url: https://registry.npmjs.org/
            - name: Run script
              run: bash .github/scripts/fetch-youtube.sh
              env:
                  DISCORD_WEBHOOK_URI: ${{ secrets.DISCORD_WEBHOOK_URI }}
            - name: Commit
              run: bash .github/scripts/commit.sh
              env:
                  TOKEN: ${{ secrets.TOKEN }}
                  REPOSITORY: ${{ github.repository }}
                  DISCORD_WEBHOOK_URI: ${{ secrets.DISCORD_WEBHOOK_URI }}
                  MESSAGE: "Update YouTube video list"
